name: Generate Project Page

on:
  push:
    branches:
      - feature/gh-page-generation
  workflow_dispatch:

jobs:
  build-and-deploy:
    runs-on: ubuntu-latest

    steps:
      - name: ðŸ“¥ Checkout Repository
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: ðŸ“¦ GitHub Repository Metadata
        uses: varunsridharan/action-repository-meta@main
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}

      - name: ðŸ§  Dynamic Template Render
        uses: varunsridharan/action-dynamic-readme@main
        with:
          files: |
            .github/templates/README.template.md=README.md
          confirm_and_push: false # Important if use "Require a pull request before merging" rule
        env:
          GITHUB_TOKEN: ${{ secrets.GH_TOKEN }}
          PROJECT_NAME: Notion

      - name: ðŸ“„ Copy README to gh-pages
        run: |
          mkdir -p gh-pages
          cp README.md gh-pages/index.md

      - name: ðŸš€ Deploy to GitHub Pages
        uses: peaceiris/actions-gh-pages@v4
        with:
          github_token: ${{ secrets.GH_TOKEN }}
          publish_dir: ./gh-pages
          publish_branch: gh-pages
